Sub AssembleData()
    Dim wsAssemble As Worksheet, wsAssembled As Worksheet, wsSource As Worksheet
    Dim sheetNames As Range, cell As Range
    Dim lastRow As Long, sourceLastRow As Long
    Dim arrData As Variant, arrFiltered() As Variant
    Dim i As Long, j As Long, filterCount As Long
    
    ' Check if 'Assemble' sheet exists
    On Error Resume Next
    Set wsAssemble = ThisWorkbook.Sheets("Assemble")
    On Error GoTo 0
    If wsAssemble Is Nothing Then
        MsgBox "'Assemble' sheet not found!", vbCritical
        Exit Sub
    End If
    
    ' Prepare 'Assembled' sheet
    Application.DisplayAlerts = False
    On Error Resume Next
    ThisWorkbook.Sheets("Assembled").Delete
    On Error GoTo 0
    Set wsAssembled = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
    wsAssembled.Name = "Assembled"
    Application.DisplayAlerts = True
    
    ' Get list of sheets to process
    Set sheetNames = wsAssemble.Range("B2", wsAssemble.Cells(wsAssemble.Rows.Count, "B").End(xlUp))
    
    For Each cell In sheetNames
        ' Validate sheet exists
        On Error Resume Next
        Set wsSource = ThisWorkbook.Sheets(cell.Value)
        On Error GoTo 0
        If wsSource Is Nothing Then
            MsgBox "Sheet '" & cell.Value & "' not found!", vbExclamation
            GoTo NextSheet
        End If
        
        ' Find last row with data in columns E, F, or G
        sourceLastRow = GetLastRow(wsSource)
        If sourceLastRow = 0 Then GoTo NextSheet
        
        ' Load data into array
        arrData = wsSource.Range("E1:G" & sourceLastRow).Value
        
        ' Filter out completely empty rows
        ReDim arrFiltered(1 To UBound(arrData, 1), 1 To 3)
        filterCount = 0
        For i = 1 To UBound(arrData, 1)
            If Not IsEmptyRow(arrData, i) Then
                filterCount = filterCount + 1
                For j = 1 To 3
                    arrFiltered(filterCount, j) = arrData(i, j)
                Next j
            End If
        Next i
        
        ' Copy filtered data to Assembled sheet
        If filterCount > 0 Then
            With wsAssembled
                lastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
                If lastRow = 1 And Len(.Range("A1").Value) = 0 Then lastRow = 0
                .Cells(lastRow + 1, "A").Resize(filterCount, 3).Value = arrFiltered
            End With
        End If

NextSheet:
    Next cell
    
    ' Final cleanup
    With wsAssembled
        .Columns("A:C").AutoFit
        .Range("A1:C1").Value = Array("Column E", "Column F", "Column G")
    End With
    
    MsgBox "Data assembled successfully!", vbInformation
End Sub

Function GetLastRow(ws As Worksheet) As Long
    ' Find last row with data in columns E, F, or G
    GetLastRow = Application.Max( _
        ws.Cells(ws.Rows.Count, "E").End(xlUp).Row, _
        ws.Cells(ws.Rows.Count, "F").End(xlUp).Row, _
        ws.Cells(ws.Rows.Count, "G").End(xlUp).Row)
End Function

Function IsEmptyRow(arr As Variant, rowIndex As Long) As Boolean
    ' Check if all three columns in the row are empty
    IsEmptyRow = (Trim(arr(rowIndex, 1) & arr(rowIndex, 2) & arr(rowIndex, 3)) = "")
End Function
