Sub DeleteEmptyRowsInSelection()
    Dim rng As Range
    Dim rowsToDelete As Range
    Dim ws As Worksheet
    Dim row As Range
    Dim lastRow As Long

    ' Check if a range is selected
    If Selection Is Nothing Then
        MsgBox "Please select a range of rows."
        Exit Sub
    End If

    ' Set the worksheet
    Set ws = Selection.Worksheet

    ' Determine the last row in the selection
    lastRow = Selection.Rows(Selection.Rows.Count).row

    ' Loop through each row in the selection
    For Each row In ws.Rows(Selection.row & ":" & lastRow)
        ' Check if the entire row is empty
        If Application.WorksheetFunction.CountA(row) = 0 Then
            If rowsToDelete Is Nothing Then
                Set rowsToDelete = row
            Else
                Set rowsToDelete = Union(rowsToDelete, row)
            End If
        End If
    Next row

    ' Delete the empty rows
    If Not rowsToDelete Is Nothing Then
        rowsToDelete.Delete
    End If
End Sub

